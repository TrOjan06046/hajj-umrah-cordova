<!--A Design by W3layouts
Author: W3layout
Author URL: http://w3layouts.com
License: Creative Commons Attribution 3.0 Unported
License URL: http://creativecommons.org/licenses/by/3.0/
-->
<!DOCTYPE html>
<html lang="en">
<head>
<title>SapaHaji</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="Flat Profile App Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android  Compatible web template, Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design" />
<script type="application/x-javascript"> addEventListener("load", function() {setTimeout(hideURLbar, 0); }, false); function hideURLbar(){ window.scrollTo(0,1); } </script>
<meta charset utf="8">
       <!--font-awsome-css-->
<link rel="stylesheet" href="css/font-awesome.min.css"> 
		<!--bootstrap-->
<link href="css/bootstrap.min.css" rel="stylesheet" type="text/css">
		<!--custom css-->
<link href="css/style.css" rel="stylesheet" type="text/css"/>
<!--component-css-->
<script src="js/jquery-2.1.4.min.js"></script>
<script src="js/bootstrap.min.js"></script>
<link rel="stylesheet" type="text/css" href="css/waitMe.min.css">
<script src="js/waitMe.min.js"></script>
<script src="js/loader.js"></script>
<script src="js/moment.js"></script>
<script src="js/moment-precise-range.js"></script>
<!-- <link type="text/css" rel="stylesheet" href="css/style2.css" />
<link rel="stylesheet" type="text/css" href="css/component.css" /> -->
<script type="text/javascript" src="js/base_url.js"></script>
			 <!--script-->
<script src="js/bigSlide.js"></script>
    <script>
		$(document).ready(function() {
		$('.menu-link').bigSlide({
		    menu: '#menu',
		    side: 'right'
	  	});
	});
    </script>
            <!--script-->
<script src="js/responsiveslides.min.js"></script>
	 <script>
		$(function () {
		  $("#slider").responsiveSlides({
			auto: true,
			nav: true,
			speed: 500,
			namespace: "callbacks",
			pager: true,
		  });
		});
	  </script>
		<!--script-->
		<script src="js/pie-chart.js" type="text/javascript"></script>
 <script type="text/javascript">

        $(document).ready(function () {
           
			 $('#demo-pie-1').pieChart({
                barColor: '#68b828',
                trackColor: '#E4E2E2',
                lineCap: 'butt',
                lineWidth: 10,
                onStep: function (from, to, percent) {
                    $(this.element).find('.pie-value').text(Math.round(percent) + '%');
                }
            });

            $('#demo-pie-2').pieChart({
                barColor: '#5bc0de',
                trackColor: '#E4E2E2',
                lineCap: 'butt',
                lineWidth: 10,
                onStep: function (from, to, percent) {
                    $(this.element).find('.pie-value').text(Math.round(percent) + '%');
                }
            });

            $('#demo-pie-3').pieChart({
                barColor: '#d9534f',
                trackColor: '#E4E2E2',
                lineCap: 'square',
                lineWidth: 10,
                onStep: function (from, to, percent) {
                    $(this.element).find('.pie-value').text(Math.round(percent) + '%');
                }
            });

           
        });

    </script>
<link href='//fonts.googleapis.com/css?family=Josefin+Sans:400,700italic,700,600italic,400italic,600,300italic,300,100italic,100' rel='stylesheet' type='text/css'>
</head>
<body>
	<div class="body-back">
		<div class="masthead pdng-stn1">
			<div id="menu" class="panel" role="navigation">
				<div class="wrap-content">

					<div class="profile-menu text-center" id="commentlist" style="max-height: 470px; overflow: auto; ">
						<!-- <img class="img-circle border-effect" src="images/pic3.png" alt=" ">
							<h3>Robb Hatman</h3>
								<h4><a href="#">Admin</a></h4>
							<div class="social-icon">
							<ul>
								<li><a href="#" class="facebook"><i class="fa fa-facebook"></i> facebook</a></li>
								<li><a href="#" class="twitter"><i class="fa fa-twitter"></i> twitter</a></li>
								<li><a href="#" class="google"><i class="fa fa-google"></i> google</a></li>
							</ul>
							</div> -->

							<div class="comment">
	                            <div class="media" style="background-color: white;background-color: #ccc;border-bottom: solid 1px;">
	                              <div class="media-left">
	                                <a href="#">
	                                  <img class="media-object photo-profile" src="http://0.gravatar.com/avatar/38d618563e55e6082adf4c8f8c13f3e4?s=40&d=mm&r=g" width="32" height="32" alt="..." style="margin: 10px;">
	                                </a>
	                              </div>
	                              <div class="media-body">
	                                <a href="#" class="anchor-username"><h6 class="media-heading" style="margin-top: 10px;">Media heading</h6></a> 
	                                <p style="font-size: 8px;"> Komentara Bla ... Bla ... Bla ...</p>
	                                <!-- <a class="anchor-time">51 mins</a> -->
	                              </div>
	                            </div>
	                       </div>

	                      


					</div>
					<div class="search" style="background-color: #e5e91f;">
						<!-- <form>
							<input type="search" value="Search" onfocus="this.value = '';" onblur="if (this.value == '') {this.value = 'Search';}" required="">
							<input type="submit" value=" ">
						</form> -->
						<a onclick="logout()" ><img src="images/icons/pack02-05-512.png" style="width: 30px;" class="logoapps" alt=" "></i> Log Out</a>
					</div> 
				</div>
			</div>
			<div class="phone-box wrap push">
				<div class="menu-notify">
					<!-- <div class="profile-left">
						<a href="#menu" class="menu-link"><i class="fa fa-chevron-left"></i></a>
					</div> -->
					<div class="Profile-mid">
						<img src="images/dsgn/header.png" class="logoapps" alt=" ">
					</div>
					<div class="Profile-right">
						<a href="#menu" class="menu-link"><img src="images/icons/Bell.png" style="width: 30px;" class="logoapps" alt=" "></i></a>
					</div>
					<!-- <div class="Profile-right">
						<div id="dd1" class="wrapper-dropdown-1" tabindex="1"><i class="fa fa-gear"></i>
							<ul class="dropdown">
								<li><a href="#">Edit Profile </a></li>
								<li><a href="#">Help</a></li>
								<li><a href="#">Activity log</a></li>
								<li><a href="#">Log Out</a></li>
							</ul>
								<script type="text/javascript">
															function DropDown(el) {
																this.dd = el;
																this.initEvents();
															}
															DropDown.prototype = {
																initEvents : function() {
																	var obj = this;
												
																	obj.dd.on('click', function(event){
																		$(this).toggleClass('active');
																		event.stopPropagation();
																	});	
																}
															}
															$(function() {
												
																var dd = new DropDown( $('#dd1') );
												
																$(document).click(function() {
																	// all dropdowns
																	$('.wrapper-dropdown-1').removeClass('active');
																});
												
															});
								</script>
						</div>
					</div> -->
					<div class="clearfix"></div>
				</div>
				
					
					<div class="contact">
						<section class="post-heading">
		                    <div class="row">
		                        <div class="col-md-12">
		                            <div class="media">
		                              <div class="media-left">
		                                <a href="#">
		                                  <img class="media-object photo-profile" id="fotouser" src="http://0.gravatar.com/avatar/38d618563e55e6082adf4c8f8c13f3e4?s=40&d=mm&r=g" width="40" height="40" alt="..." style="border-radius: 50%;">
		                                </a>
		                              </div>
		                              <div class="media-body">
		                                <a class="anchor-username"><h4 class="media-heading" id="namauser">Bayu Darmantra</h4></a> 
		                                <a onclick="showloc()"><i class="glyphicon glyphicon-map-marker"></i> add Location</a>
		                                <!-- <a class="anchor-time">51 mins</a> <a class="anchor-time">51 mins</a> -->
		                              </div>
		                            </div>
		                        </div>
		                        
		                    </div>             
		               </section>
						<form>
							<!-- <input type="text" placeholder="Name" required="">
							<input type="text" class="mail" placeholder="Email" required="">-->
							<input id="loctxt" type="text" class="hidden" placeholder="Type Your Location Here"> 

							<img id="postpic" src="" alt="" title="" class="hidden"  style="width: 100%" />
							<video width="400" controls id="prevvid"  class="hidden" style="width: 100%" >
								<source src="" id="videopic">
							</video>

							<textarea id="statuspost" placeholder="Write Sometext here ..."></textarea>
							<input type="button" onclick="addpost()" value="Post">
							<input type="file" name="file-1[]" id="file-1" class="inputfile inputfile-1" data-multiple-caption="{count} files selected" multiple="" style="width: 0.1px;height: 0.1px;opacity: 0;overflow: hidden;position: absolute;">
                			<label for="file-1" style="float: right;padding-top: -4px;padding-top: 5px;padding-bottom: 6px;background-color: #e68523;margin-top: 14px;color: white;width: 50px;text-align: -webkit-center;">
    							<svg xmlns="http://www.w3.org/2000/svg" width="20" height="17" viewBox="0 0 20 17">
    								<path d="M10 0l-5.2 4.9h3.3v5.1h3.8v-5.1h3.3l-5.2-4.9zm9.3 11.5l-3.2-2.1h-2l3.4 2.6h-3.5c-.1 0-.2.1-.2.1l-.8 2.3h-6l-.8-2.2c-.1-.1-.1-.2-.2-.2h-3.6l3.4-2.6h-2l-3.2 2.1c-.4.3-.7 1-.6 1.5l.6 3.1c.1.5.7.9 1.2.9h16.3c.6 0 1.1-.4 1.3-.9l.6-3.1c.1-.5-.2-1.2-.7-1.5z">
    									
    								</path>
    							</svg> 
    							<span>
    								
    							</span>
    						</label>
    						<script type="text/javascript">
			                  	document.getElementById("file-1").onchange = function () {
			                  		var file = this.files[0];
			                  		var fileext = file.type;
			                  		console.log(file.type);
			                  		console.log(fileext);
				                    var reader = new FileReader();

				                    var filetype = fileext.split('/');


				                    reader.onload = function (e) {
				                      // get loaded data and render thumbnail.
				                      	if (filetype[0] == 'image') {
											document.getElementById("postpic").src = e.target.result;
											$('#postpic').removeClass('hidden');
											$('#prevvid').addClass('hidden');
				                      	} else if (filetype[0] == 'video') {
				                      		var $source = $('#videopic');
											$source[0].src = URL.createObjectURL(file);
											$source.parent()[0].load();
				                      		// document.getElementById("videopic").src = e.target.result;
				                      		$('#postpic').addClass('hidden');
				                      		$('#prevvid').removeClass('hidden');
				                      	} else{
				                      		alert('Format tidak didukung ...');
				                      		clearFileInput("file-1");
				                      		$('#postpic').addClass('hidden');
				                      		$('#prevvid').addClass('hidden');
				                      	}
				                        
				                    };

				                    // read the image file as a data URL.
				                    reader.readAsDataURL(this.files[0]);
			                  	};

			                  	function clearFileInput(id){ 
								    var oldInput = document.getElementById(id); 

								    var newInput = document.createElement("input"); 

								    newInput.type = "file"; 
								    newInput.id = oldInput.id; 
								    newInput.name = oldInput.name; 
								    newInput.className = oldInput.className; 
								    newInput.style.cssText = oldInput.style.cssText; 
								    // TODO: copy any other relevant attributes 

								    oldInput.parentNode.replaceChild(newInput, oldInput); 
								}

								
			                </script>


						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
	<div id="footer" style="background-color: #f9ff07;">
		<div class="col-xs-12 navbar-inverse navbar-fixed-bottom">
		  	<div class="row" id="bottomNav">
			    <div class="col-xs-4 text-center"><a href="home.html"><i class="glyphicon glyphicon-home circle"></i></a></div>
			    <div class="col-xs-4 text-center"><a href="laporfloat.html"><i class="glyphicon glyphicon-plus circle"></i></a></div>
			    <div class="col-xs-4 text-center"><a href="profile.html"><i class="glyphicon glyphicon-user circle"></i></a></div>
			    <!-- <div class="col-xs-4 text-center"><a href="#"><img src="images/n2.jpg" class="img-responsive" alt=""></a></div>
			    <div class="col-xs-4 text-center"><a href="#"><img src="images/n2.jpg" class="img-responsive" alt=""></a></div>
			    <div class="col-xs-4 text-center"><a href="#"><img src="images/n2.jpg" class="img-responsive" alt=""></a></div> -->
		  	</div>
		</div>
	</div>
<script src="js/jquery.nicescroll.js"></script>
<script src="js/scripts.js"></script>
<script type="text/javascript">
	function showloc() {
		// body...
		$('#loctxt').removeClass('hidden');
	}
</script>
<script type="text/javascript">
	$(function () {
    
	    // if (localStorage.user) {
	    //     console.log('session ON');
	    //     console.log(localStorage.user);
	    //     // home();
	    // } else{
	    //     console.log('session OFF');
	    //     logout();
	    // }
	    run_waitMe('#postlist', 'ios');
	    if (localStorage.user) {
        console.log('session ON');
        console.log(localStorage.user);
        var form_data = new FormData();
        form_data.append('id', localStorage.user);
        form_data.append('typepost', 'all');

		$.ajax({
            url: base_url+'getprofile.php', // point to server-side PHP script 
            dataType: 'json',  // what to expect back from the PHP script, if anything
            cache: false,
            contentType: false,
            processData: false,
            data: form_data,
            type: 'post',
            success: function(profile){
              	var listpost = '';
              	console.log(profile);
              	console.log(profile['Data_Status'][0]['Status']);
              	if (profile['Data_Status'][0]['Data']) {
                console.log(profile['Data_Status'][0]['Data']);
                var datapost = profile['Data_Status'][0]['Data'];
                
                if (datapost[0]['idlogin']) {

                	document.getElementById('fotouser').src = datapost[0]['profile_pic'];
                } else {

                	document.getElementById('fotouser').src = base_url_profilepic+datapost[0]['profile_pic'];
                }
                // document.getElementById('fotouser').src = base_url_profilepic+datapost[0]['profile_pic'];
                document.getElementById('namauser').innerHTML = datapost[0]['nama_depan'];
                // document.getElementById('tanggalgabung').innerHTML = datapost[0]['is_create_at'];

              	} else {
                console.log(profile['Data_Status'][0]['Status']);
                // alert('List Unavailable');
              	}
            }
        });

		var nform_data = new FormData();
        nform_data.append('idc', localStorage.user);
         $.ajax({
            url: base_url+'getlistnotifcomment.php', // point to server-side PHP script 
            dataType: 'json',  // what to expect back from the PHP script, if anything
            cache: false,
            contentType: false,
            processData: false,
            data: nform_data,
            type: 'post',
            success: function(commentf){
              	var listcomment = '';
              	console.log(commentf);
              	console.log(commentf['List_Status'][0]['Status']);
              	if (commentf['List_Status'][0]['Data']) {
                console.log(commentf['List_Status'][0]['Data']);
                var datapost = commentf['List_Status'][0]['Data'];

                // console.log(datapost);
                for (var i = 0; i < datapost.length; i++) {

                	if (datapost[i]['comment_by'] != localStorage.user) {
						listcomment += '<div class="comment" onclick="goto_post('+datapost[i]['id_post']+')">';
						listcomment += '<div class="media" style="background-color: white;background-color: #ffffff;border-bottom: solid 1px;">';
						listcomment += '<div class="media-left">';
						listcomment += '<a href="#">';
						if (datapost[i]['idlogin']) {
							var temppic = datapost[i]['profile_pic'];
							var spic = temppic.split('://');
							if (spic[1]) {
								listcomment += '<img class="media-object photo-profile" src="'+datapost[i]['profile_pic']+'" width="32" height="32" alt="..." style="margin: 10px;">';
							} else {
								listcomment += '<img class="media-object photo-profile" src="'+base_url_profilepic+datapost[i]['profile_pic']+'" width="32" height="32" alt="..." style="margin: 10px;">';
							}
							
						} else {
							listcomment += '<img class="media-object photo-profile" src="'+base_url_profilepic+datapost[i]['profile_pic']+'" width="32" height="32" alt="..." style="margin: 10px;">';
						}
						
						
						listcomment += '</a>';
						listcomment += '</div>';
						listcomment += '<div class="media-body">';
						listcomment += '<a class="anchor-username"><h6 class="media-heading" style="margin-top: 10px;color: black;"> </h6></a> ';
						if (datapost[i]['com_type'] == 'comment') {
							listcomment += '<p style="font-size: 8px;float: left;margin-left: 10px;">'+datapost[i]['nama_depan']+' Mengomentari post anda : '+datapost[i]['comment_text']+'</p>';
						} else {
							listcomment += '<p style="font-size: 8px;float: left;margin-left: 10px;">'+datapost[i]['nama_depan']+' Menyukai post anda</p>';
						}

						listcomment += '<p style="font-size: 8px;float: left;margin-left: 10px;">'+get_time(datapost[i]['create_at'])+'</p>';
						
						listcomment += '</div>';
						listcomment += '</div>';
						listcomment += '</div>';
                	}

					
                  
                }

                console.log(listcomment);
                
                document.getElementById('commentlist').innerHTML = listcomment;

              	} else {
	                console.log(commentf['List_Status'][0]['Status']);
	                document.getElementById('commentlist').innerHTML = '';
                // alert('List Unavailable');
              	}
            }
        });
        // home();
      } else{
        console.log('session OFF');
        logout();
      }
    
    });

	function addpost(){
		var form_data = new FormData();
		var loctxt = document.getElementById('loctxt').value;
    	var statustxt = document.getElementById('statuspost').value; 
    	var file_name = document.getElementById('file-1').value; 
    	var file_data = document.getElementById('file-1').files[0]; 
    	form_data.append('id', localStorage.user);
    	form_data.append('note', statustxt);
    	form_data.append('location', loctxt);
		form_data.append('ImageFile', file_data);
		console.log(form_data); 
		console.log(file_data);
		if ( statustxt || file_name ) {
			$.ajax({
				url: base_url+'add_timeline.php', // point to server-side PHP script 
				dataType: 'json',  // what to expect back from the PHP script, if anything
				cache: false,
				contentType: false,
				processData: false,
				data: form_data,                         
				type: 'post',
				success: function(posting){
					console.log(posting);
	            	if (posting['Create_Status'][0]['Status'] == 'Success') {
	            		home();
	            	} else {
	            		document.getElementById('statuspost').value = '';
						document.getElementById('statuspost').focus();
	            	}
				}
			});
		} else {
			if (!statustxt) {
				document.getElementById('statuspost').value = '';
				document.getElementById('statuspost').focus();
			}
		}
				
	}

	function home() {
		// alert(typec);		
		location.href = "home.html";

	}

    function logout(){
      	localStorage.clear();
      	console.log('session OFF');
      	location.href = "index.html";  
    }

    function get_time(dtime) {
    	// body...
    	var thisDate = moment().format('YYYY-MM-DD HH:mm:ss');
    	console.log(dtime);
    	console.log(thisDate);
    	var startTime = dtime;
		var endTime = thisDate;
		var hours = parseInt(moment.duration(moment(endTime, 'YYYY/MM/DD HH:mm').diff(moment(startTime, 'YYYY/MM/DD HH:mm'))).asHours());
		var mints = parseInt(moment.duration(moment(endTime, 'YYYY/MM/DD HH:mm').diff(moment(startTime, 'YYYY/MM/DD HH:mm'))).asMinutes());
		console.log(hours);
		if (mints <= 60) {
			return mints+' Minutes Ago';
		} else if (hours <= 24) {
			return hours+' Hours Ago';
		} else {
			return dtime;
		}
		
    }
    function goto_post(id) {
    	// body...
    	localStorage.iddetail = id;
    	location.href = "detailpost.html?id="+id;
    }
    function detail(id) {
    	// body...
    	localStorage.iddetail = id;
    	location.href = "detailpost.html?id="+id;
    }
</script>
<script type="text/javascript">
	function editprofile() {
		// alert(typec);		
		location.href = "editprofile.html";

	}
</script>
</body>
</html>